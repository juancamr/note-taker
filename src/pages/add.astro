---
import Layout from "../layouts/Layout.astro"
import { createNote } from "../data/note"

if (Astro.request.method === "POST") {
    try {
        const data = await Astro.request.formData();
        const title = data.get("title");
        const content = data.get("content");
        const note = { title, content }

        if (typeof title !== "string" || title.length < 1) {
            return
        }

        if (typeof content !== "string" || content.length < 1) {
            return 
        }

        await createNote(note); 
        Astro.response.redirect("/notes");
    } catch (error) {
        if (error instanceof Error) {
            console.error(error.message);
        }
    }
}
---

<Layout title="Add note">
    <form method="post" class="space-y-4 product-font mt-12">
        <h2 class="text-2xl font-bold ">Add note</h1>
            <div>
                <input placeholder="Title" name="title" class="w-full text-lg h-10 focus:ring-0 focus:ring-offset-0 border-0 outline-none bg-black " />
                <hr />
            </div>
            <textarea name="content" class="w-full rounded-lg bg-slate-800 outline-none text-white h-[40vh]  p-2" style="resize: none;"/>
            <button type="submit" class="px-4 py-2  bg-blue-600 rounded-xl text-white mb-12" >Guardar</button>
    </form>
</Layout>
